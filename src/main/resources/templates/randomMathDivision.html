<html>

<head>
	<meta charset="utf-8">
	<Title>Random Math</Title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="divisionAjaxCalls.js"></script>
	<script src="../getImageOperator.js"></script>
	<script src="../operationSimulator.js"></script>
	
	<link rel="stylesheet" type="text/css" href="../css/randomMath.css">
	<link rel="stylesheet" type="text/css" href="../css/backgroundImg.css">
</head>

<body>
	<div id="pageTitle" class="pageTitle">Math Rush</div>
	<div id="scoreHandling">
		<label id="correctAnswers" class="scoreDisplay"></label><br/>
		<label id="over" class="scoreDisplay">___</label><br/>
		<label id="allQuestions" class="scoreDisplay"></label><br/>
	</div>
	
	<div id="opacityBox"></div>
	
	<table id="tableHBox">
		<tr>
			<td><label id="var1" class="vars"></label></td>
			<!--  don't set the source so I do not have a wrong operator displayed first -->
			<td><img id="operator"></td>
			<td><label id="var2" class="vars"></label></td>
			<td><img id="equalSign" src="../img/equalSign.PNG" alt="Equal sign"></td>
			<td><input type="text" id="answerText"></td>
			<td><input type="submit" value="Submit" id="submitAnswer"></td>
		</tr>
		<tr>
			<td></td>
		</tr>
	</table>
	
	<label id="feedback"></label>
	
	<table id="explanationTable">
		<tr>
			<!-- Comments explaining the steps -->
			<td><label id="commentSimulation" class="simVal"></label></td>
		</tr>
		<tr>
			<td><input type="button" id="restartSimulation" value="Restart Division Simulation"/></td>
		</tr>
	</table>
	
	
	<!-- Shows the formal way of doing the addition -->
	<table id="simulationTable">
		<tr>
			<td></td>
			<td></td>
			<td class="widerColumn"></td>
			<!--  This row handles the answers. (how many times two go in 1? sort of thing) -->
			<td class="simVal" id="answerHundredDigit"></td>
			<td class="simVal" id="answerDecadeDigit"></td>
			<td class="simVal" id="answerUnitDigit"></td>
		</tr>
		<tr>
			<!-- This row shows the operands -->
			<td class="simVal" id="operand2DecadeDigit"></td>
			<td class="simVal" id="operand2UnitDigit"></td>
			<td class="simVal widerColumn" id="separator"></td>
			
			<td class="simVal" id="operand1HundredDigit"></td>
			<td class="simVal" id="operand1DecadeDigit"></td>
			<td class="simVal" id="operand1UnitDigit"></td>
		</tr>
		<!-- Adding three more rows for subtractions -->
		<tr>
			<!-- First number subtracted from value -->
			<td></td>
			<td></td>
			<td class="widerColumn"><img id="operator1" src="../img/blank.png"></td>
			<td class="simVal" id="firstValHundredDigit"></td>
			<td class="simVal" id="firstValDecadeDigit"></td>
			<td class="simVal" id="firstValUnitDigit"></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td colspan="3" id="answerBar1" class="simVal"></td>
		</tr>
		<tr>
			<!-- First answer subtraction-->
			<td></td>
			<td></td>
			<td class="widerColumn"></td>
			<td class="simVal" id="firstAnswerHundredDigit"></td>
			<td class="simVal" id="firstAnswerDecadeDigit"></td>
			<td class="simVal" id="firstAnswerUnitDigit"></td>
		</tr>
		<tr>
			<!-- Second number subtracted from value -->
			<td></td>
			<td></td>
			<td class="widerColumn"><img id="operator2" src="../img/blank.png"></td>
			<td class="simVal" id="secondValHundredDigit"></td>
			<td class="simVal" id="secondValDecadeDigit"></td>
			<td class="simVal" id="secondValUnitDigit"></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td colspan="3" id="answerBar2" class="simVal"></td>
		</tr>
		<tr>
			<!-- Second answer subtraction-->
			<td></td>
			<td></td>
			<td class="widerColumn"></td> 
			<td class="simVal" id="secondAnswerHundredDigit"></td>
			<td class="simVal" id="secondAnswerDecadeDigit"></td>
			<td class="simVal" id="secondAnswerUnitDigit"></td>
		</tr>
	</table>
	
	<script>
	//to handle the answer response so it does not get modified, you can 
	//simply give the response ("Nice job!" or "Sorry, wrong answer.")
	//thus, the answer response has no way of being modified
		var operator = -1;
		var var2 = -1;
		var var1 = -1;
		var totalAnswers = 0;
		var correctAnswers = 0;
		//tells you how many tries were made to get the answer
		var counterTries = 0;
		var output = "";
		const answerX = false;
		$(document).ready(function(){
			//to restart the animation
			$("#restartSimulation").click(function(){
				simulateDivision(var1, var2);
			});
			
			//get the operator and second operand
			$.when(getOperator(), getOperand2()).done(function(){
				//get the first operand next, because we want a whole number as response
				$.when(getOperand1(var2), getCorrectAnswersValue(), getTotalAnswersValue()).done(function(){
					$('#operator').attr('src', srcOperatorImage(operator));
					//setting values of labels
					$('#var1').html(var1);
					$('#var2').html(var2);
					
					//setting values for score
					$('#correctAnswers').html(correctAnswers);
					$('#allQuestions').html(totalAnswers);
				});
			});
			
			//same thing as above, but this time this is generated from a click
			$('#submitAnswer').click(function(){
				$.when(getAnswer($("#answerText").val())).done(function(){
						$('#feedback').html(output);
						
						//increments the tries to the question
						counterTries++;
						if(output.localeCompare("Nice Job!") == 0){
							//change equation
							setTimeout(function(){
								$.when(getOperator(), getOperand2()).done(function(){
									//get the first operand next, because we want a whole number as response
									$.when(getOperand1(var2), getCorrectAnswersValue(), getTotalAnswersValue()).done(function(){
										$('#operator').attr('src', srcOperatorImage(operator));
										//setting values of labels
										$('#var1').html(var1);
										$('#var2').html(var2);
										
										output = "";
										$('#feedback').html(output);
										$('#feedback').css("left","40%");
										//setting values for score
										$('#correctAnswers').html(correctAnswers);
										$('#allQuestions').html(totalAnswers);
									});
								});
							}, 1000);
							
							counterTries = 0;
						}
						else{
							setTimeout(function(){
								$('#feedback').html("Oops! You got the wrong answer. Look below to know how to do this operation correctly.");
								$('#feedback').css("left","20%");
								
								//show the tables
								setTimeout(function(){									
									$("#commentSimulation").show();
									$("#simulationTable").show();
									simulateDivision(var1, var2);
									$("#restartSimulation").show();
								}, 1000);
							}, 1000);
							
							
							//to reset the tries and go to the next question. Good or not?
							counterTries = 0;
						}
				})
				
			});
			
		});
		
		
	</script>
</body>
</html>